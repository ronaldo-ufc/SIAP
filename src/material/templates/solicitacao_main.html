{% extends "base.html" %}
{% import "forms.html" as forms %}
{% import "uteis.html" as functions %}
{% import "funcoes.html" as msg %}

{% block content %}
<div class="col-md-12">
  <!--{{ forms.error_message(form, mensagem )}}-->
  {{ msg.messagem(classe, texto)}}
</div>
<div class="col-md-12">
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <ul class="nav navbar-nav">
        <li><a  style="color: #4cae4c; font-size: 1.2em" href="solicitacoes/novo"><i class="fas fa-cart-plus"></i> Nova Solicitação</a></li>
      </ul>
    </div>
  </nav>
</div>
<div class="col-md-12">
  <div class="panel panel-default">
    <div class="panel-heading"><h4>Solicitações de Bens de Consumo - {{setor_nome}}</h4></div>
    <div class="panel-body">
      <div class="row">
        <a onclick="alert('Funcionalidade em desenvolvimento')" style="cursor: pointer" class="btn btn-lg btn-block" data-toggle="collapse" href="#collapseFiltro" role="button" aria-expanded="true" aria-controls="collapseFiltro"><i class="fas fa-search"></i> Filtros</a>
      </div>
      <br>
      <form name="cadastro" action="" method="POST">
        <div class="row">
          <div class="col-md-12">
            <table id="tabelaItens" class="table-hover table-bordered">
              <thead class="bg-primary">
                <tr>
                  <th>Número</th>
                  <th>Data Sol.</th>
                  <th>Solicitante</th>
                  <th>Recebimento</th>
                  <th>Situação</th>
                  <th class="text-center">Ações</th>
                </tr>
              </thead>
              <tbody>
                {% for solicitacao in solicitacoes %}
                <tr >
                  <th > {{solicitacao.numero}}</th>
                  <td > {{solicitacao.data|date('d/m/Y')}}</td>
                  <td title=""> {{solicitacao.usuario.nome}}</td>
                  <td title=""> {{solicitacao.recebimento_user.nome}}</td>
                  <td > <span class="badge badge-{{ solicitacao.StatusClass }}">{{solicitacao.statusnome}}</span></td>
                  <td class="col-md-2 text-center">
                    <a title="Inserir Itens na Solicitação" href="solicitacoes/{{solicitacao.requisicao_codigo}}"> <i  class="fas fa-shopping-cart fa-2x"></i></a> &nbsp;&nbsp;&nbsp;
                    <a style="display:{{solicitacao.statusdisplay}};" title="Enviar Solicitação" href="solicitacoes/enviar/{{solicitacao.requisicao_codigo}}"> <i style="color: #4cae4c" class="fas fa-cloud-upload-alt fa-2x"></i></a> &nbsp;&nbsp;&nbsp;
                    <a style="display: {{solicitacao.showBtnConfirmarRecebimento}}" onclick="setRecebimento('{{solicitacao.requisicao_codigo}}')" title="Confirmar Recebimento" data-toggle="modal" data-target="#modalConfirmarRecebimento" href="#"> <i style="color: #008000" class="far fa-thumbs-up fa-2x"></i></a> &nbsp;&nbsp;&nbsp;
                    <!--   <a title="Excluir" onclick="return confirm('Tem certeza que deseja excluir a Solicitação {{solicitacao.numero}} e todos seus ítens?')" href="solicitacoes/excluir/{{solicitacao.requisicao_codigo}}"><i style="display:{{solicitacao.statusdisplay}}; color: red" class="far fa-trash-alt fa-2x"></i></a> -->
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade" id="modalConfirmarRecebimento" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Confirmação de Recebimento</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="confirmar-recebimento" method="POST">
          <input type="hidden" name="requisicao" id="requisicao">
          <div class="row">
            <div class="col-md-12">
              <label for="login">Login</label>
              <input name="login" id="login" type="text" class="form-control">
            </div>
            <div class="col-md-12">
              <label for="senha">Senha</label>
              <input name="senha" id="senha" type="password" class="form-control">
            </div>
          </div><br>
          <div class="row">
            <div class="col-md-12">
              <button type="submit"  class="btn btn-success">Confirmar Recebimento </button>
              <button type="button" class="btn btn-default" data-dismiss="modal">Sair</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{{ functions.modalEntrada() }}
{% endblock %}
