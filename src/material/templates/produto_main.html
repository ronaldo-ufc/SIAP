{% extends "base.html" %}
{% import "forms.html" as forms %}
{% import "uteis.html" as functions %}
{% import "funcoes.html" as msg %}

{% block content %}
<div class="col-md-12">
  <!--{{ forms.error_message(form, mensagem )}}-->
  {{ msg.messagem(classe, texto)}}
</div>
<div class="col-md-12">
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <ul class="nav navbar-nav">
        <li><a href="produto/novo"><i class="fas fa-box-open"></i> Novo Ítem</a></li>
        <li><a data-toggle="collapse" href="#collapseFiltro" role="button" aria-expanded="true" aria-controls="collapseFiltro"><i class="fas fa-search"></i> Filtros</a>
        </li>
      </ul>
    </div>
  </nav>
</div>
<div class="col-md-12">
  <div class="panel panel-default">
    <div class="panel-heading"><h4>Materiais de consumo</h4></div>
    <div class="panel-body">
      <div class="collapse" id="collapseFiltro">
        <div class="alert">
          <form action="" method="GET">
            <div class="row">
              <div class="col-md-2">
                <label for="c_ufc" class="control-label">Cód. UFC</label>
                <input name="c_ufc" type="text" class="form-control" id="c_ufc">
              </div>
              <div class="col-md-2">
                <label for="c_barras" class="control-label">Cód. Barras</label>
                <input name="c_barras" type="text" class="form-control" id="c_barras">
              </div>
              <div class="col-md-4">
                <label for="nome" class="control-label">Descrição</label>
                <input name="nome" type="text" class="form-control" id="nome" >
              </div>
              <div class="col-md-2">
                <label for="unidade" class="control-label">Unidade</label>
                <select name="unidade" class="form-control" id="unidade" >
                  <option value="%">Todas</option>
                  {% for unidade in unidades  %}
                  <option value="{{unidade.unidade_codigo}}">{{unidade.nome}}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="col-md-2">
                <label for="grupo" class="control-label">Grupo</label>
                <select name="grupo" class="form-control" id="grupo" >
                  <option value="%">Todos</option>
                  {% for grupo in grupos  %}
                  <option value="{{grupo.grupo_codigo}}">{{grupo.nome}}</option>
                  {% endfor %}
                </select>
              </div>

            </div>
            <div class="row">
              <div class="col-md-12">
                <div class="form-group green-border-focus">
                  <label for="observacao">Observação</label>
                  <textarea class="form-control" id="observacao" name="observacao" rows="4"></textarea>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <div class="form-group"><br>
                  <button  type="submit" class="btn btn-default">
                    <i class="fas fa-search"></i> Filtrar
                  </button>
                  <a class="btn btn-default" data-toggle="collapse" href="#collapseFiltro" role="button" aria-expanded="true" aria-controls="collapseFiltro"><i class="fas fa-times"></i> Cancelar</a>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <form name="cadastro" action="" method="POST">
        <div class="row">
          <div class="col-md-12">
            <table id="tabela" class="table table-hover table-condensed">
              <thead class="bg-primary">
                <tr>
                  <th></th>
                  <th>Código UFC</th>

                  <th>Descrição</th>
                  <th class="text-right">Quantidade</th>
                  <th>Unidade</th>

                  <th>Grupo</th>
                  <th>Status</th>
                  <th class="text-center">Ações</th>
                </tr>
              </thead>
              <tbody>
                {% for produto in produtos %}
                <tr class="{{produto.getCorClassQuantidadeMinima}}" ondblclick="editarProduto('{{produto.produto_codigo}}')">
                  <td style="width: 60px"><img class="img-ativo-show"  style="background-image: url(' {{base_url()}}/uploads/imagem/{{produto.imagem}} '); " style="width: 55px;" class="img-thumbnail img-responsive" src="{{base_url()}}/uploads/imagem/{{produto.imagem}}">
                  </td>
                  <td > {{produto.getCodigo_ufc()}}</td>

                  <td title="{{produto.observacao}}"> {{produto.nome}}</td>

                  <td class="text-right" title="Quantidade Mínima: {{produto.quantidade_minima}}"> {{produto.quantidade}}</td>
                  <td > {{produto.unidade.nome}}</td>
                  <td > {{produto.grupo.nome}}</td>
                  <td > {{produto.statusNome}}</td>
                  <td class="col-md-1 text-center">
                    <a href="editar"> {{functions.btnAddEntrada(produto.nome~'|'~produto.produto_codigo, 'Entrada no estoque')}}</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <a title="Excluir" onclick="return confirm('Tem certeza que deseja excluir o produto {{produto.nome}} ?')" href="excluir/{{produto.produto_codigo}}"><i style="color: #900000" class="far fa-trash-alt fa-2x"></i></a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

{{ functions.modalMovimentacao() }}

<script>
  function verifica(value){
  var input = document.getElementById("requisicao");
  if (value == 'R'){
  input.disabled = false;
  } else{
  input.disabled = true;
  input.value = null;
  }
  };
</script>
{% endblock %}
